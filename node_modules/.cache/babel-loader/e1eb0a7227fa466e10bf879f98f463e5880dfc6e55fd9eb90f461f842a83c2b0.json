{"ast":null,"code":"// src/components/SearchBar.js\nimport React,{useState,useEffect,useRef}from'react';import{useNavigate}from'react-router-dom';import'./SearchBar.css';import{fetchRoutes}from'../api/api';// import fetchRoutes function\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function SearchBar(){const[query,setQuery]=useState('');const[results,setResults]=useState([]);const navigate=useNavigate();const timerRef=useRef(null);const handleSearch=e=>{e.preventDefault();if(query.trim()){navigate(\"/search?query=\".concat(encodeURIComponent(query)));}};// Function to fetch results using fetchRoutes - from backend\nconst getSearchResults=async searchQuery=>{if(searchQuery.trim()===''){setResults([]);return;}try{const response=await fetchRoutes(searchQuery);// Assuming the response data is an array of routes\nconst routes=response.data.routes;// Set top 5 results\nsetResults(routes.slice(0,5));// Adjust as needed\n}catch(error){console.error('Error fetching results',error);setResults([]);}};// Effect to handle debounced search queries\nuseEffect(()=>{// Clear the previous timer\nif(timerRef.current){clearTimeout(timerRef.current);}// If the query is empty, clear results\nif(query.trim()===''){setResults([]);return;}// Set a new timer to fetch results after 100ms\ntimerRef.current=setTimeout(()=>{getSearchResults(query);},100);// Cleanup function to clear the timer when the component unmounts or query changes\nreturn()=>{if(timerRef.current){clearTimeout(timerRef.current);}};},[query]);// Handle clicking on a result\nconst handleResultClick=result=>{// Navigate to the result's page or set the query\nnavigate(\"/route/\".concat(result._id));// Adjust the path according to your routes\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"search-bar\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,autoComplete:\"off\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for routes or crags\",value:query,onChange:e=>setQuery(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Search\"})]}),results.length>0&&query.trim()!==''&&/*#__PURE__*/_jsx(\"ul\",{className:\"search-results\",children:results.map(result=>{return/*#__PURE__*/_jsxs(\"li\",{onClick:()=>handleResultClick(result),children:[/*#__PURE__*/_jsx(\"strong\",{children:result.name}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"em\",{children:result.crag}),\" - \",/*#__PURE__*/_jsx(\"em\",{children:result.area})]},result._id);})})]});}export default SearchBar;","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","fetchRoutes","jsx","_jsx","jsxs","_jsxs","SearchBar","query","setQuery","results","setResults","navigate","timerRef","handleSearch","e","preventDefault","trim","concat","encodeURIComponent","getSearchResults","searchQuery","response","routes","data","slice","error","console","current","clearTimeout","setTimeout","handleResultClick","result","_id","className","children","onSubmit","autoComplete","type","placeholder","value","onChange","target","length","map","onClick","name","crag","area"],"sources":["/Users/starteyapais/Documents/SolicitedSpray/frontend/src/components/SearchBar.js"],"sourcesContent":["// src/components/SearchBar.js\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './SearchBar.css';\nimport { fetchRoutes } from '../api/api'; // import fetchRoutes function\n\nfunction SearchBar() {\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState([]);\n  const navigate = useNavigate();\n  const timerRef = useRef(null);\n\n  const handleSearch = (e) => {\n    e.preventDefault();\n    if (query.trim()) {\n      navigate(`/search?query=${encodeURIComponent(query)}`);\n    }\n  };\n\n  // Function to fetch results using fetchRoutes - from backend\n  const getSearchResults = async (searchQuery) => {\n    if (searchQuery.trim() === '') {\n      setResults([]);\n      return;\n    }\n\n  try {\n    const response = await fetchRoutes(searchQuery);\n    // Assuming the response data is an array of routes\n    const routes = response.data.routes;\n\n    // Set top 5 results\n    setResults(routes.slice(0, 5)); // Adjust as needed\n  } catch (error) {\n    console.error('Error fetching results', error);\n    setResults([]);\n  }\n};\n\n// Effect to handle debounced search queries\n  useEffect(() => {\n    // Clear the previous timer\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n    }\n\n    // If the query is empty, clear results\n    if (query.trim() === '') {\n      setResults([]);\n      return;\n    }\n\n    // Set a new timer to fetch results after 100ms\n    timerRef.current = setTimeout(() => {\n      getSearchResults(query);\n    }, 100);\n\n    // Cleanup function to clear the timer when the component unmounts or query changes\n    return () => {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n      }\n    };\n  }, [query]);\n\n  // Handle clicking on a result\n  const handleResultClick = (result) => {\n    // Navigate to the result's page or set the query\n    navigate(`/route/${result._id}`); // Adjust the path according to your routes\n  };\n\n  return (\n    <div className=\"search-bar\">\n      <form onSubmit={handleSearch} autoComplete=\"off\">\n        <input\n          type=\"text\"\n          placeholder=\"Search for routes or crags\"\n          value={query}\n          onChange={(e) => setQuery(e.target.value)}\n        />\n        <button type=\"submit\">Search</button>\n      </form>\n      {results.length > 0 && query.trim() !== '' && (\n        <ul className=\"search-results\">\n          {results.map((result) => {\n            return (<li key={result._id} onClick={() => handleResultClick(result)}>\n       <strong>{result.name}</strong>\n       <br/>\n       <em>{result.crag}</em> - <em>{result.area}</em>\n       {/* Assuming result.crag exists */}\n          </li>\n          );\n          })}\n        </ul>\n      )}\n    </div>\n  );\n}\n\nexport default SearchBar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}